"use strict";!function(){angular.module("jukebox",["ngRoute","ngAnimate","ui.bootstrap","as.sortable","ngTouch","ngCookies","matchMedia","spotify"]).directive("compile",["$compile","$timeout",function(e,t){return{restrict:"A",link:function(o,a){t(function(){e(a.contents())(o)})}}}]).config(["$compileProvider","$routeProvider","$locationProvider","SpotifyProvider",function(e,t,o,a){e.debugInfoEnabled(!1),t.when("/dataviz",{controller:"DatavizController",templateUrl:"dataviz/dataviz.html"}).when("/spotify_login",{templateUrl:"dataviz/spotify_login.html"}).when("/:roomId",{controller:"QueueController",templateUrl:"queue/queue.html"}).when("/",{controller:"HomeController",templateUrl:"home/home.html"}).otherwise({redirectTo:"/"}),o.html5Mode(!0),a.setClientId("39903cb10e0a4f6da882d6c53db62776"),a.setRedirectUri("http://letsjukebox.com/spotify_login/"),a.setScope("user-library-read user-top-read")}])}(),function(){function e(e){e.changeXAxisCategory=function(){if("time"==e.axisCategory.x.value){for(var t=0;t<e.musicTracks.length;t++)e.musicTracks[t].x_category=e.musicTracks[t].date,e.musicTracks[t].x_category_val="time";e.changeXScaleToDate()}else{for(var t=0;t<e.musicTracks.length;t++)e.musicTracks[t].x_category=e.musicTracks[t].audio_features[e.axisCategory.x.value],e.musicTracks[t].x_category_val=e.axisCategory.x.value;e.changeXScaleToFeature()}e.updateAxisLabels(),e.updateGraph()},e.changeYAxisCategory=function(){for(var t=0;t<e.musicTracks.length;t++)e.musicTracks[t].y_category=e.musicTracks[t].audio_features[e.axisCategory.y.value],e.musicTracks[t].y_category_val=e.axisCategory.y.value;e.updateAxisLabels(),e.updateGraph()},e.changeTopTimePeriod=function(){document.getElementById("mygraph").classList=[],document.getElementById("mygraph").classList.add(e.selectedTimePeriod),e.toggleHiddenNonTopTracks()},e.toggleHiddenNonTopTracks=function(){e.nonTopTracksHidden?document.getElementById("mygraph").classList.add("hide-non-top"):document.getElementById("mygraph").classList.remove("hide-non-top")}}angular.module("jukebox").controller("GraphControlsController",e),e.$inject=["$scope"]}(),function(){function e(e,t){function o(){function t(){e.xAxisIsLocked&&e.yAxisIsLocked||(e.xAxisIsLocked?(m.selectAll("circle").classed("animate",!1).attr("cy",function(e){return c(e.y_category)}),d3.select(".y.axis").call(g)):e.yAxisIsLocked?(m.selectAll("circle").classed("animate",!1).attr("cx",function(e){return c(e.x_category)}),d3.select(".x.axis").call(d)):(m.selectAll("circle").classed("animate",!1).attr("cx",function(e){return c(e.x_category)}).attr("cy",function(e){return u(e.y_category)}),d3.select(".x.axis").call(d),d3.select(".y.axis").call(g)))}var o=!0,f=!1,v=void 0;try{for(var h,y=a[Symbol.iterator]();!(o=(h=y.next()).done);o=!0){var b=h.value;"time"==e.axisCategory.x.value?(b.date=l(b.added_at),b.x_category=b.date,b.x_category_val="time"):(b.x_category=b.audio_features[e.axisCategory.x.value],b.x_category_val=e.axisCategory.x.value),b.y_category=b.audio_features[e.axisCategory.y.value],b.y_category_val=e.axisCategory.y.value}}catch(k){f=!0,v=k}finally{try{!o&&y.return&&y.return()}finally{if(f)throw v}}c.domain(d3.extent(a,function(e){return e.x_category})),u.domain([0,d3.max(a,function(e){return e.y_category})+.1]),m.append("rect").attr("width",s+n.left+n.right+r).attr("height",i+n.top+n.bottom+r);var x=m.append("text").attr("y",i/2+25).attr("x",n.left).attr("class","axis-label x left"),_=m.append("text").attr("y",i/2+25).attr("x",s-150).attr("class","axis-label x right"),T=m.append("text").attr("y",n.top).attr("x",s/2-r).attr("class","axis-label y top"),I=m.append("text").attr("y",i-r/2).attr("x",s/2-r).attr("class","axis-label y bottom");e.updateAxisLabels=function(){"time"==e.axisCategory.x.value?(x.text(""),_.text("")):(x.text("low "+e.axisCategory.x.value),_.text("high "+e.axisCategory.x.value)),T.text("high "+e.axisCategory.y.value),I.text("low "+e.axisCategory.y.value)},e.updateAxisLabels(),m.selectAll("dot").data(a).enter().append("circle").attr("class","dot").attr("class",function(e){return e.is_top.length>0?"top "+e.is_top.join(" "):void 0}).attr("r",8).style("opacity",.5).attr("cx",function(e){return c(e.x_category)}).attr("cy",function(e){return u(e.y_category)}).on("mouseover",function(e){d3.select(this).attr("r",16).classed("selected",!0),p.transition().duration(200).style("opacity",.8).attr("r",30),p.html(function(){if("time"==e.x_category_val){var t=new Date(e.x_category),o=t.toLocaleString();return e.name+"<br>"+e.artists[0].name+'<br><div class="subtext">'+e.y_category+" "+e.y_category_val+"<br>Added "+o+"<br></div>"}return e.name+"<br>"+e.artists[0].name+'<br><div class="subtext">'+e.y_category+" "+e.y_category_val+"<br>"+e.x_category+" "+e.x_category_val+"<br></div>"}).style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-parseInt(p.node().getBoundingClientRect().height+10)+"px")}).on("mouseout",function(){d3.select(this).attr("r",8).classed("selected",!1),p.transition().duration(500).style("opacity",0)}).on("click",function(t){e.playSelectedSong(t.name,t.artists[0].name)}),m.append("g").attr("class","x axis").call(d).attr("transform","translate(0,"+i+")"),m.append("g").attr("class","y axis").call(g),m.call(d3.behavior.zoom().x(c).y(u).on("zoom",t)),e.changeXScaleToDate=function(){c=d3.time.scale().range([r,s]),c.domain(d3.extent(a,function(e){return e.x_category})),d=d3.svg.axis().scale(c).orient("bottom").ticks(5).tickSize(8),m.call(d3.behavior.zoom().x(c).y(u).on("zoom",t))},e.changeXScaleToFeature=function(){c=d3.scale.linear().range([r,s]),c.domain([0,d3.max(a,function(e){return e.x_category})+.1]),d=d3.svg.axis().scale(c).orient("bottom").ticks(5).tickSize(8),m.call(d3.behavior.zoom().x(c).y(u).on("zoom",t))},e.toggleYAxisLock=function(){e.yAxisIsLocked=!e.yAxisIsLocked},e.updateGraph=function(){m.selectAll("circle").classed("animate",!0).attr("cx",function(e){return c(e.x_category)}).attr("cy",function(e){return u(e.y_category)}),d3.select(".x.axis").call(d),d3.select(".y.axis").call(g)}}e.selectedTimePeriod="long_term",e.axisCategories=[{name:"Danceability",value:"danceability"},{name:"Energy",value:"energy"},{name:"Speechiness",value:"speechiness"},{name:"Acousticness",value:"acousticness"},{name:"Instrumentalness",value:"instrumentalness"},{name:"Liveness",value:"liveness"},{name:"Valence",value:"valence"},{name:"Date added",value:"time"}],e.axisCategory={x:e.axisCategories[7],y:e.axisCategories[1]},e.xAxisIsLocked=!1,e.yAxisIsLocked=!1;var a,n={top:20,right:20,bottom:30,left:60},r=50,s=1400-n.left-n.right,i=530-n.top-n.bottom,l=d3.time.format.iso.parse,c=d3.time.scale().range([r,s]),u=d3.scale.linear().range([i,r/2]),d=d3.svg.axis().scale(c).orient("bottom").ticks(5).tickSize(8),g=d3.svg.axis().scale(u).orient("left").ticks(5).tickSize(8),m=d3.select(".mydiv").append("svg").attr("width",s+n.left+n.right).attr("height",i+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")"),p=d3.select(".mydiv").append("div").attr("class","tooltip").style("opacity",0);e.loadFromSampleData?t.get("resources/"+e.loadFromSampleData+"_data.json").then(function(t){e.musicTracks=t.data,a=e.musicTracks,o()}):(a=e.musicTracks,o())}angular.module("jukebox").controller("GraphController",e),e.$inject=["$scope","$http"]}(),function(){function e(e,t,o,a,n){function r(t,o){s(t,o).success(function(t){t.items.length>=1&&(e.yt_video_id=t.items[0].id.videoId)}).error(function(e){console.log("ERROR YoutubeController.updateCurrentVideo",e)})}function s(e,t){return o({url:"https://www.googleapis.com/youtube/v3/search",method:"GET",params:{part:"snippet",key:i,q:e+" "+t,type:"video",videoEmbeddable:"true"}})}var i="AIzaSyALGbklexv5u7P3zjV4xJCYfEYLwwukfkE";e.room=n,e.yt_video_id="";e.$on("updateVideoEvent",function(e,t,o){r(t,o)})}angular.module("jukebox").controller("YoutubeController",e).filter("youtubeEmbedUrl",["$sce",function(e){return function(t){return e.trustAsResourceUrl("http://www.youtube.com/embed/"+t+"?autoplay=1&iv_load_policy=3&origin=http://letsjukebox.com/")}}]),e.$inject=["$scope","$rootScope","$http","$sce","sharedRoomData"]}(),function(){function e(){return{restrict:"A",replace:!0,template:'<div class="spinner"> <!-- kudos to Tobias Ahlin! [http://tobiasahlin.com/spinkit/] --> <div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>'}}angular.module("jukebox").directive("spinner",e)}(),function(){angular.module("jukebox").factory("sharedRoomData",function(){var e={roomId:"",roomName:"",allAdmin:!1,passwordProtected:!1,roomPassword:"",userId:"",userName:"",loaded:!1,queue:{},trending:[]};return e})}(),function(){function e(){return{restrict:"A",replace:!0,templateUrl:"common/plusButton/plusButton.html",controller:["$scope","$uibModal",function(e,t){e.showSearch=function(){t.open({templateUrl:"search/search.html",controller:"SearchController",windowClass:"search-page",keyboard:!1})}}]}}angular.module("jukebox").directive("plusButton",e)}(),function(){function e(){return{restrict:"A",replace:!0,scope:{currentlyPlaying:"="},templateUrl:"common/header/header.html"}}angular.module("jukebox").directive("header",e).filter("spotifyEmbedUrl",["$sce",function(e){return function(t){return e.trustAsResourceUrl("https://embed.spotify.com/?uri="+t)}}])}(),function(){function e(){return{restrict:"A",replace:!0,scope:{},templateUrl:"common/footer/footer.html"}}angular.module("jukebox").directive("footer",e)}(),function(){angular.module("jukebox").factory("backendAPI",["$http",function(e){var t="/api",o={};e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var a=function n(e){var t,o,a,r,s,i,l,c="";for(t in e)if(o=e[t],o instanceof Array)for(l=0;l<o.length;++l)s=o[l],a=t+"["+l+"]",i={},i[a]=s,c+=n(i)+"&";else if(o instanceof Object)for(r in o)s=o[r],a=t+"["+r+"]",i={},i[a]=s,c+=n(i)+"&";else void 0!==o&&null!==o&&(c+=encodeURIComponent(t)+"="+encodeURIComponent(o)+"&");return c.length?c.substr(0,c.length-1):c};return e.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?a(e):e}],o.registerUser=function(o){return e.post(t+"/register_user",o)},o.changeUsername=function(o){return e.post(t+"/change_username",o)},o.joinRoom=function(o){return e.post(t+"/join_room",o)},o.getSongQueue=function(o){return e({method:"GET",url:t+"/get_song_queue",params:o})},o.addSong=function(o){return e.post(t+"/submit_song",o)},o.reorderSong=function(o){return e.post(t+"/reorder_song",o)},o.deleteSong=function(o){return e.post(t+"/delete_song",o)},o.searchRooms=function(o){return e.post(t+"/search_room",o)},o.getTrendingSongs=function(){return e.get(t+"/get_trending_songs")},o}])}(),function(){function e(){return{restrict:"A",replace:!0,scope:{},templateUrl:"search/search.html",controller:["$scope",function(){}]}}angular.module("jukebox").directive("search",e)}(),function(){function e(e,t,o,a,n,r){function s(){a.getSongQueue({room_id:n.roomId,password:n.password}).success(function(e){"OK"===e.status?(n.roomName=e.room_name,n.queue=e.data,console.log("OK backendAPI.getSongQueue",e)):console.log("NOT OK backendAPI.getSongQueue",e)}).error(function(e){console.log("ERROR backendAPI.getSongQueue",e)})}e.roomId=t.roomId,e.querying=!0,e.myData={},e.myData.spotify={},e.myData.spotify.suggestions=n.trending,e.myData.sendQuery=function(){e.querying=!0;var t=o.get("https://api.spotify.com/v1/search",{params:{q:e.searchText,type:"track"}});t.success(function(t){e.querying=!1,console.log("OK SearchController.sendQuery",t),e.myData.spotify.results=t.tracks.items}),t.error(function(){e.querying=!1,e.myData.spotify.results=null,console.log("ERROR returning results from spotify")})},e.closeSearch=function(){r.close()},e.addSong=function(t,o,r,i,l){a.addSong({room_id:n.roomId,user_id:n.userId,password:n.password,url:t,track:o,artist:r,album:i,album_art_url:l}).success(function(t){"OK"===t.status?(s(),console.log("OK backendAPI.addSong",t)):console.log("NOT OK backendAPI.addSong",t),e.closeSearch()}).error(function(e){console.log("ERROR backendAPI.addSong",e)})}}angular.module("jukebox").controller("SearchController",e),e.$inject=["$scope","$routeParams","$http","backendAPI","sharedRoomData","$uibModalInstance"]}(),function(){angular.module("jukebox").controller("QueueController",["$scope","$rootScope","$interval","$routeParams","$cookies","$uibModal","backendAPI","sharedRoomData","screenSize",function(e,t,o,a,n,r,s,i,l){function c(){r.open({templateUrl:"common/ui-elements/defaultModal.html",controller:["$scope","$sce","$uibModalInstance","sharedRoomData",function(e,t,o,a){e.modal_title="Enter Your Alias",e.modal_body_html=t.trustAsHtml('<span>@</span><input type="text" ng-model="aliasInput" class="form-control" autofocus required />'),e.primary_btn_text="CONTINUE",e.ok=function(){e.aliasInput&&!/[^a-zA-Z0-9]/.test(e.aliasInput)&&(o.close(),a.userName=e.aliasInput,u(a.userName))}}],backdrop:"static",windowClass:"default",keyboard:!1})}function u(e){s.registerUser({username:e}).success(function(e){"OK"===e.status?(i.userId=e.data,n.put("jb_user_name",i.userName),n.put("jb_user_id",i.userId),d(),console.log("OK backendAPI.registerUser",e)):console.log("NOT OK backendAPI.registerUser",e)}).error(function(e){console.log("ERROR backendAPI.registerUser",e)})}function d(){s.joinRoom({room_id:i.roomId,user_id:i.userId,password:i.password}).success(function(e){"OK"===e.status?(console.log("OK backendAPI.joinRoom",e),g()):("The correct password was not provided."===e.message&&(i.passwordProtected=!0,i.password=window.prompt("Enter the password:"),n.put(i.roomId,i.password),d()),console.log("NOT OK backendAPI.joinRoom",e))}).error(function(e){console.log("ERROR backendAPI.joinRoom",e)})}function g(){s.getSongQueue({room_id:i.roomId,password:i.password}).success(function(e){"OK"===e.status?(console.log("OK backendAPI.getSongQueue",e),i.roomName=e.room_name,i.queue=e.data,i.allAdmin="1"==e.all_admin?!0:!1,i.loaded=!0,v||(v=o(function(){f||g()},h))):("The correct password was not provided."===e.message&&(i.passwordProtected=!0,i.password=window.prompt("Enter the password:"),n.put(i.roomId,i.password),g()),console.log("NOT OK backendAPI.getSongQueue",e))}).error(function(e){console.log("ERROR backendAPI.getSongQueue",e)})}function m(e,t){s.reorderSong({room_id:i.roomId,user_id:i.userId,password:i.password,song_id:e,new_pos:t}).success(function(e){"OK"===e.status?(console.log("OK backendAPI.reorderSong",e),g()):console.log("NOT OK backendAPI.reorderSong",e)}).error(function(){console.log("ERROR backendAPI.reorderSong",error)})}function p(e){s.deleteSong({room_id:i.roomId,user_id:i.userId,password:i.password,song_id:e}).success(function(e){"OK"===e.status?(console.log("OK backendAPI.deleteSong",e),g()):console.log("NOT OK backendAPI.deleteSong",e)}).error(function(){console.log("ERROR backendAPI.deleteSong",error)})}e.pageClass="queue-page";var f=!1,v=void 0,h=3e3;t.responsiveVersion=l.is("xs, sm")?"mobile":"desktop",e.mobile=l.on("xs, sm",function(o){e.mobile=o,t.responsiveVersion=o?"mobile":"desktop"}),e.room=i,i.roomId=a.roomId,e.roomId=i.roomId;var y=["BlueTrout","YellowDuck","RedHerring","BoredMoose","SillyWhale","OrangeEagle","VelvetMouse","GreenMonkey","VioletLobster","ConfusedTucan","WileySloth"];if(i.userId=n.get("jb_user_id"),i.userName=n.get("jb_user_name"),i.password=n.get(i.roomId)?n.get(i.roomId):"",i.userId&&i.userName)console.log("You already have a username! It is "+i.userName),d();else{var b=y[Math.floor(Math.random()*y.length)];c(b)}s.getTrendingSongs().success(function(e){"OK"===e.status?(console.log("OK backendAPI.getTrendingSongs",e),i.trending=e.data.map(function(e){return e.track})):console.log("NOT OK backendAPI.getTrendingSongs",e)}).error(function(e){console.log("ERROR backendAPI.getTrendingSongs",e)}),e.dragControlListeners={accept:function(){return!0},dragStart:function(){f=!0},dragEnd:function(){f=!1},orderChanged:function(e){var t=e.source.itemScope.element[0].dataset.uuid,o=e.dest.index;m(t,o)},containment:".song-queue"},e.deleteSong=function(e){var t=e.target.parentElement.dataset.uuid;p(t)}}])}(),function(){function e(e,t,o){function a(t,o){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(o){e.logoFill="url(#lg)",console.log("Location acquired.");var a=o.coords.latitude,n=o.coords.longitude;e.coordinates=[a,n],console.log(e.coordinates),t&&t()},function(){o&&o()},{timeout:1e3*n},{maximumAge:1e3*r}):o&&o()}var n=30,r=60;e.pageClass="home-page",e.coordinates=[],a(function(){o.searchRooms({coordinates:e.coordinates[0]+","+e.coordinates[1],distance:"10000"}).success(function(e){"OK"===e.status?(console.log("OK backendAPI.searchRooms",e),e.data.length>=1?t.path(e.data[0].id):console.log("No nearby rooms available.")):console.log("NOT OK backendAPI.searchRooms",e)}).error(function(e){console.log("NOT OK backendAPI.searchRooms",e)})},function(){console.log("Could not get location.")})}angular.module("jukebox").controller("HomeController",e),e.$inject=["$scope","$location","backendAPI","$http"]}(),function(){function e(e,t,o,a){function n(e){return 0===Object.keys(e).length}function r(t,o,n){a.getTracksAudioFeatures(t).then(function(t){e.featureRequestsToMake-=1;for(var a=0;a<t.audio_features.length;a++)o+1==n.length?(n[n.length-n.length%100+a]!=t.audio_features[a].id&&console.log("There is a problem at ",o,a),e.musicData[n[n.length-n.length%100+a]].audio_features=t.audio_features[a]):(o+1)%100==0?(n[o+1-100+a]!=t.audio_features[a].id&&console.log("There is a problem at ",o,a),e.musicData[n[o+1-100+a]].audio_features=t.audio_features[a]):console.log("This should never happen...")}).catch(function(e){console.log("Something went wrong!"),console.log(e)})}function s(t){e.featureRequestsToMake=Math.ceil(t.length/100);for(var o="",a=0;a<t.length;a++)o+=t[a]+",",((a+1)%100==0||a+1==t.length)&&(o=o.slice(0,-1),r(o,a,t),o="")}function i(t,o){a.getSavedUserTracks({offset:t,limit:o}).then(function(a){return console.log(t,a.items),e.savedTrackList=e.savedTrackList.concat(a.items),a.items.length<o?(console.log("Saved tracks finished loading!",e.savedTrackList),l(),!0):(setTimeout(function(){i(t+o,o)},100),void 0)}).catch(function(t){console.log("Something went wrong!"),console.log(t),e.errorText="Error importing Spotify library. Please click Get Songs again."})}function l(){a.getUserTopTracks({limit:50,time_range:"long_term"}).then(function(t){for(var o=0;o<t.items.length;o++)e.topTracks.long_term[t.items[o].id]=t.items[o];return!0}),a.getUserTopTracks({limit:50,time_range:"medium_term"}).then(function(t){for(var o=0;o<t.items.length;o++)e.topTracks.medium_term[t.items[o].id]=t.items[o];return!0}),a.getUserTopTracks({limit:50,time_range:"short_term"}).then(function(t){for(var o=0;o<t.items.length;o++)e.topTracks.short_term[t.items[o].id]=t.items[o];return!0})}e.loadFromSampleData="",e.pageClass="dataviz-page",e.musicLoadingIsComplete=!1,e.getSongsClicked=!1,e.errorText="",e.tutorialVisible=!0,e.musicData={},e.musicTracks=[],e.savedTrackList=[],e.topTracks={long_term:{},medium_term:{},short_term:{}},e.userIsLoggedIn=!1,e.login=function(){a.login(),e.userIsLoggedIn=!0},e.getSongs=function(){e.errorText="",e.getSongsClicked=!0,e.loadFromSampleData="",e.musicLoadingIsComplete=!1,e.musicData={},e.musicTracks=[],e.savedTrackList=[],e.topTracks={long_term:{},medium_term:{},short_term:{}},i(0,50)},e.loadFromDataSet=function(t){e.loadFromSampleData=t,e.musicLoadingIsComplete=!0,e.tutorialVisible&&o(function(){e.tutorialVisible=!1},1e4)},e.playSelectedSong=function(t,o){e.$broadcast("updateVideoEvent",t,o)},e.$watch("featureRequestsToMake",function(){0==e.featureRequestsToMake&&(console.log("Music loading is complete!",e.musicData),e.musicTracks=Object.keys(e.musicData).map(function(t){return e.musicData[t]}),e.musicLoadingIsComplete=!0,e.tutorialVisible&&o(function(){e.tutorialVisible=!1},1e4))}),e.$watch("topTracks",function(){if(!n(e.topTracks.long_term)&&!n(e.topTracks.medium_term)&&!n(e.topTracks.short_term)){console.log("All top tracks finished loading!",e.topTracks);var t=!0,o=!1,a=void 0;try{for(var r,i=e.savedTrackList[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var l=r.value,c=l.track;c.added_at=l.added_at,c.is_top=[],e.topTracks.long_term[c.id]&&c.is_top.push("long_term"),e.topTracks.medium_term[c.id]&&c.is_top.push("medium_term"),e.topTracks.short_term[c.id]&&c.is_top.push("short_term"),e.musicData[c.id]=c}}catch(u){o=!0,a=u}finally{try{!t&&i.return&&i.return()}finally{if(o)throw a}}s(Object.keys(e.musicData))}},!0)}angular.module("jukebox").controller("DatavizController",e),e.$inject=["$scope","$http","$timeout","Spotify"]}(),function(e){try{e=angular.module("jukebox")}catch(t){e=angular.module("jukebox",[])}e.run(["$templateCache",function(e){e.put("/jukebox/dataviz/dataviz.html",'<div class="dataviz-page"><div class="header"><div class="contents"><div>Project Jukebox</div><button ng-click="login()">Login</button> <button ng-click="getSongs()" ng-disabled="!userIsLoggedIn">Get&nbsp;Your&nbsp;Songs</button></div></div><div class="notifications"><div ng-if="!userIsLoggedIn && !loadFromSampleData" class="explainer-text">Click Login to authorize Jukebox to pull data from your Spotify account.<br>Alternatively, load a sample data set.<br><button ng-click="loadFromDataSet(\'small\')">Load&nbsp;Small&nbsp;Data&nbsp;Set</button> <button ng-click="loadFromDataSet(\'large\')">Load&nbsp;Large&nbsp;Data&nbsp;Set</button></div><div ng-if="userIsLoggedIn && !getSongsClicked && !loadFromSampleData" class="explainer-text">Click Get Your Songs to get started.</div><div ng-show="musicLoadingIsComplete && tutorialVisible" class="tutorial-text">Scroll to Zoom. Click and drag to pan.<br>Click on any data point to play that song.</div><div ng-if="errorText" class="error-text">{{errorText}}</div></div></div><div ng-if="getSongsClicked && !musicLoadingIsComplete && !errorText" class="spinner-container"><div spinner></div></div><div ng-controller="GraphController" ng-if="musicLoadingIsComplete"><div class="graph-view"><div id="mygraph" ng-class="selectedTimePeriod"><div class="mydiv"></div></div></div><div ng-controller="GraphControlsController"><div class="graph-controls-view"><div class="control-box"><div class="control-item"><span style="color: yellow">Highlight</span> top tracks from<select ng-model="selectedTimePeriod" ng-change="changeTopTimePeriod()" name="time-period"><option value="long_term">all time</option><option value="medium_term">last 6 months</option><option value="short_term">last 4 weeks</option></select></div><div class="control-item">Fade non top tracks? <input type="checkbox" ng-change="toggleHiddenNonTopTracks()" name="hide-non-top" ng-model="nonTopTracksHidden"></div><div class="control-item">Display tracks based on<select ng-options="item as item.name for item in axisCategories" ng-model="axisCategory.x" ng-change="changeXAxisCategory()"></select>x<select ng-options="item as item.name disable when item.value == \'time\' for item in axisCategories" ng-model="axisCategory.y" ng-change="changeYAxisCategory()"></select></div><div class="control-item">Lock Y-axis on zoom? <input type="checkbox" ng-change="toggleYAxisLock()" ng-model="yAxisIsLocked" name="lock-y-axis"></div></div></div></div></div><div ng-controller="YoutubeController"><div class="iframe-container"><iframe id="ytplayer" type="text/html" ng-src="{{ yt_video_id | youtubeEmbedUrl }}" frameborder="0" allowfullscreen></div></div>')}])}(),function(e){try{e=angular.module("jukebox")}catch(t){e=angular.module("jukebox",[])}e.run(["$templateCache",function(e){e.put("/jukebox/dataviz/spotify_login.html",'<script>var hash = window.location.hash;\n  if (window.location.search.substring(1).indexOf("error") !== -1) {\n    // login failure\n    console.log("Spotify login failure.");\n    window.close();\n  } else if (hash) {\n    var token = window.location.hash.split(\'&\')[0].split(\'=\')[1];\n    if (token) {\n      // login success\n      console.log("Spotify login success.");\n      localStorage.setItem(\'spotify-token\', token);\n    } else {\n      console.log("Spotify token is undefined.");\n    }\n  }</script>')}])}(),function(e){try{e=angular.module("jukebox")}catch(t){e=angular.module("jukebox",[])}e.run(["$templateCache",function(e){e.put("/jukebox/home/home.html",'<div class="home-page"><div class="jb-icon"><svg><lineargradient id="lg" x1="1" y1="1" x2="0" y2="0"><stop offset="0%" stop-opacity="1" stop-color="white"><stop offset="0%" stop-opacity="1" stop-color="white"><animate attributename="offset" values="0;1" fill="freeze" repeatcount="0" dur="5s" begin="0s"></stop><stop offset="0%" stop-opacity="1" stop-color="black"><animate attributename="offset" values="0;1" fill="freeze" repeatcount="0" dur="5s" begin="0s"></stop><stop offset="100%" stop-opacity="1" stop-color="black"></lineargradient><use xlink:href="#plus-icon"></use></svg></div></div>')}])}(),function(e){try{e=angular.module("jukebox")}catch(t){e=angular.module("jukebox",[])}e.run(["$templateCache",function(e){e.put("/jukebox/queue/queue.html",'<div class="desktop-content"><div ng-controller="YoutubeController" ng-if="room.queue[0] && !mobile"><div class="iframe-container"><iframe id="ytplayer" type="text/html" ng-src="{{ yt_video_id | youtubeEmbedUrl }}" frameborder="0" allowfullscreen></div></div></div><div class="queue-wrapper"><div ng-if="!room.loaded" spinner></div><div ng-if="room.loaded"><div header currently-playing="room.queue[0]"></div><div class="song-queue" data-as-sortable="dragControlListeners" data-ng-model="room.queue"><div ng-repeat="song in room.queue"><div class="song-queue-item noselect" data-uuid="{{ song.unique_id }}" data-as-sortable-item ng-swipe-left="showDeleteButton = true" ng-swipe-right="showDeleteButton = false"><img src="{{ song.image_url }}" class="song-image"><div class="song-info"><div class="song-title">{{ song.track }}</div><div class="song-artist">{{ song.artist }}</div><div class="song-user">@{{ song.submitter }}</div></div><i class="fa fa-th-list drag-button" ng-if="room.allAdmin && !showDeleteButton" data-as-sortable-item-handle></i> <i class="fa fa-trash fa-lg delete-button" ng-if="room.allAdmin && showDeleteButton" ng-click="deleteSong($event)"></i></div></div></div></div></div><div plus-button></div>')}])}(),function(e){try{e=angular.module("jukebox")}catch(t){e=angular.module("jukebox",[])}e.run(["$templateCache",function(e){e.put("/jukebox/search/search.html",'<div class="search-wrapper"><div class="search-header-items"><div class="search-header-item search"><input id="song-search-box" type="search" ng-model="searchText" ng-model-options="{ debounce: 500 }" ng-change="myData.sendQuery()" placeholder="Search Spotify..." autofocus></div><div class="search-header-item close-search"><button ng-click="closeSearch()"><span>Cancel</span></button></div></div><div class="song-suggestions" ng-if="!myData.spotify.results && !searchText"><div class="song-results-header"><span>Trending</span></div><div ng-if="myData.spotify.suggestions.length > 0"><div ng-repeat="result in myData.spotify.suggestions"><div ng-click="addSong(result.uri, result.name, result.artists[0].name, result.album.name, result.album.images[0].url)" class="song-search-result"><img src="{{ result.album.images[0].url }}" class="song-image"><div class="song-info"><div class="song-title">{{ result.name }}</div><div class="song-artist">{{ result.artists[0].name }}</div></div></div></div></div></div><div class="song-search-results"><div ng-if="myData.spotify.results.length > 0"><div ng-repeat="result in myData.spotify.results"><div ng-click="addSong(result.uri, result.name, result.artists[0].name, result.album.name, result.album.images[0].url)" class="song-search-result"><img src="{{ result.album.images[0].url }}" class="song-image"><div class="song-info"><div class="song-title">{{ result.name }}</div><div class="song-artist">{{ result.artists[0].name }}</div></div></div></div></div></div><div ng-if="querying"><div spinner></div></div></div>')}])}(),function(e){try{e=angular.module("jukebox")}catch(t){e=angular.module("jukebox",[])}e.run(["$templateCache",function(e){e.put("/jukebox/common/footer/footer.html",'<div class="footer"><div class="footer-label"><span>Jukebox App</span></div><div class="footer-copyright"><span>&copy; 2016, All rights reserved.</span></div></div>')}])}(),function(e){try{e=angular.module("jukebox")}catch(t){e=angular.module("jukebox",[])}e.run(["$templateCache",function(e){e.put("/jukebox/common/header/header.html",'<div class="header"><div class="header-info" ng-if="currentlyPlaying"><div class="header-label song"><span>{{ currentlyPlaying.track }}</span></div><div class="header-label artist"><span>{{ currentlyPlaying.artist }}</span></div><div class="header-label user"><span>@{{ currentlyPlaying.submitter }}</span></div></div><div class="record-player"><div class="record" ng-if="currentlyPlaying"><img src="{{ currentlyPlaying.image_url }}"></div><div class="record" ng-if="!currentlyPlaying"><svg><use xlink:href="#plus-icon"></use></svg></div></div></div>')}])}(),function(e){try{e=angular.module("jukebox")}catch(t){e=angular.module("jukebox",[])}e.run(["$templateCache",function(e){e.put("/jukebox/common/plusButton/plusButton.html",'<button ng-click="showSearch()" class="plus-button"><div class="plus-icon"><svg><use xlink:href="#plus-icon"></use></svg></div></button>')}])}(),function(e){try{e=angular.module("jukebox")}catch(t){e=angular.module("jukebox",[])}e.run(["$templateCache",function(e){e.put("/jukebox/common/ui-elements/defaultModal.html",'<div class="default" tabindex="-1"><div class="modal-header"><h3 class="modal-title">{{ modal_title }}</h3></div><form><div class="modal-body" compile ng-bind-html="modal_body_html"></div><div class="modal-footer"><button class="btn btn-primary" type="submit" ng-click="ok()">{{ primary_btn_text }}</button><div ng-if="secondary_btn_text"><button class="btn btn-warning" type="button" ng-click="cancel()">{{ secondary_btn_text }}</button></div></div></form></div>')}])}();